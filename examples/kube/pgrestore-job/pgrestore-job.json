{
   "apiVersion":"batch/v1",
   "kind":"Job",
   "metadata":{
      "name":"pgrestore-job"
   },
   "spec":{
      "template":{
         "metadata":{
            "name":"pgrestore-job",
            "labels":{
               "app":"pgrestore-job"
            }
         },
         "spec":{
            "volumes":[
               {
                  "name":"pgdata",
                  "persistentVolumeClaim":{
                     "claimName":"crunchy-pvc"
                  }
               }
            ],
            "securityContext":{
               "supplementalGroups":[
                  65534
               ]
            },
            "containers":[
               {
                  "name":"pgrestore-job",
                  "image":"$CCP_IMAGE_PREFIX/crunchy-restore:$CCP_IMAGE_TAG",
                  "volumeMounts":[
                     {
                        "mountPath":"/pgdata",
                        "name":"pgdata",
                        "readOnly":false
                     }
                  ],
                  "env":[
                     {
                        "name":"PGRESTORE_HOST",
                        "value":"postgres-gis"
                     },
                     {
                        "name":"PGRESTORE_DB",
                        "value":"postgres"
                     },
                     {
                        "name":"PGRESTORE_USER",
                        "value":"postgres"
                     },
                     {
                        "name":"PGRESTORE_PASS",
                        "value":"password"
                     },
                     {
                        "name":"PGRESTORE_PORT",
                        "value":"5432"
                     },
                     {
                        "name":"PGRESTORE_VERBOSE",
                        "value":"true"
                     },
                     {
                        "name":"PGRESTORE_VOLUMEPATH",
                        "value":"/pgdata/postgres-gis-dumps/2018-01-29-19-06-51"
                     },
                     {
                        "name":"PGRESTORE_FILE",
                        "value":"newdump.tar"
                     },
                     {
                        "name":"PGRESTORE_CREATE",
                        "value":"true"
                     },
                     {
                        "name":"PGRESTORE_CLEAN",
                        "value":"true"
                     }
                  ]
               }
            ],
            "restartPolicy":"Never"
         }
      }
   }
}
