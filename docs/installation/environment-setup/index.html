<!DOCTYPE html>
<html>
  <head>
    <title>Crunchy Data Container Suite Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.40" />

<title>Environment Setup :: Crunchy Data Container Suite Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/crunchy-containers/favicon.ico" type="image/x-icon" />
<link href="https://crunchydata.github.io/crunchy-containers/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/css/font-awesome.min.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/css/hybrid.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/css/featherlight.min.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/css/auto-complete.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/theme-original/style.css" rel="stylesheet">

<link rel="stylesheet" href="https://crunchydata.github.io/crunchy-containers/css/bootstrap.min.css">
<script src="https://crunchydata.github.io/crunchy-containers/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<meta name="description" content="">


    
  </head>
  <body data-url="/installation/environment-setup/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <a class="baselink" href="https://crunchydata.github.io/crunchy-containers/">Crunchy Data Container Suite Documentation</a>
  

    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/js/lunr.min.js"></script>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "https:\/\/crunchydata.github.io\/crunchy-containers\/";
        
		</script>
		<script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/" class="dd-item">
            <a href="https://crunchydata.github.io/crunchy-containers/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/installation/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/installation/">Installation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="/installation/environment-setup/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/installation/environment-setup/">
            Environment Setup
          </a>
        </div>
    </li>
      <li data-nav-id="/installation/build-the-containers/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/installation/build-the-containers/">
            Build the Containers
          </a>
        </div>
    </li>
      <li data-nav-id="/installation/storage-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/installation/storage-configuration/">
            Storage Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/getting-started/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/getting-started/">Getting Started</a><i class="fa fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
    <li data-nav-id="/getting-started/openshift-templates/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/">Openshift Templates</a><i class="fa fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="/getting-started/openshift-templates/single-primary/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/single-primary/">
            Single Primary
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/primary-restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/primary-restore/">
            Primary Restore
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/primary-restore-secret/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/primary-restore-secret/">
            Primary Restore Secret
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/primary-backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/primary-backup/">
            Primary Backup
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/primary-backup-secret/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/primary-backup-secret/">
            Primary Backup Secret
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/postgres-replicated/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/postgres-replicated/">
            Primary Replica
          </a>
        </div>
    </li>
      <li data-nav-id="/getting-started/openshift-templates/pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/getting-started/openshift-templates/pgadmin4/">
            pgAdmin4
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/getting-started/kubernetes-and-openshift/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/getting-started/kubernetes-and-openshift/">Kubernetes and Openshift</a>

      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/container-specifications/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/">Container Specifications</a><i class="fa fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="/container-specifications/crunchy-postgres/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-postgres/">
            crunchy-postgres
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-postgres-gis/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-postgres-gis/">
            crunchy-postgres-gis
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-backup/">
            crunchy-backup
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-backrest-restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-backrest-restore/">
            crunchy-backrest-restore
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgdump/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgdump/">
            crunchy-pgdump
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgrestore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgrestore/">
            crunchy-pgrestore
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-collect/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-collect/">
            crunchy-collect
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-prometheus/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-prometheus/">
            crunchy-prometheus
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-grafana/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-grafana/">
            crunchy-grafana
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgadmin4/">
            crunchy-pgadmin4
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-watch/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-watch/">
            crunchy-watch
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-vacuum/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-vacuum/">
            crunchy-vacuum
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-upgrade/">
            crunchy-upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-sim/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-sim/">
            crunchy-sim
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-dba/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-dba/">
            crunchy-dba
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgbouncer/">
            crunchy-pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgpool/">
            crunchy-pgpool
          </a>
        </div>
    </li>
      <li data-nav-id="/container-specifications/crunchy-pgbadger/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/container-specifications/crunchy-pgbadger/">
            crunchy-pgbadger
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/contributing/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/contributing/">Contributing</a>

      </div>
    </li>



        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/CrunchyData/crunchy-containers" target="_blank" rel="noopener"><i class='fa fa-github'></i> <label>Github repo</label></a></li>
                <li class="" role=""><a href="https://kubernetes.io/docs/" target="_blank" rel="noopener"><i class='fa fa-bookmark'></i> <label>Kubernetes Documentation</label></a></li>
                <li class="" role=""><a href="https://github.com/CrunchyData/crunchy-containers/blob/master/LICENSE.md" target="_blank" rel="noopener"><i class='fa fa-file'></i> <label>License</label></a></li>
        </section>

    <hr />
    <li></li>

    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    
      
      
      
    <div id="top-github-link">
      <a class="github-link" href="https://crunchydata.github.io/crunchy-containers/contributing/" target="blank">
        <i class="fa fa-info-circle"></i>
        How to contribute
      </a>
      <a class="github-link" href="https://github.com/CrunchyData/crunchy-containers/edit/master/hugo/content/installation/environment-setup.adoc" target="blank">
        <i class="fa fa-code-fork"></i>
        Improve this page
      </a>
    </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        







 <a href='https://crunchydata.github.io/crunchy-containers/'>Crunchy Data Container Suite</a> > <a href='https://crunchydata.github.io/crunchy-containers/installation/'>Installation</a> > Environment Setup






        </span>
    </div>

    
    <div class="progress">
        <div class="wrapper">
    
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Environment Setup</h1>
  



    
    
    
    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_project_environment">Project Environment</a></li>
<li><a href="#_installing_requirements">Installing Requirements</a>
<ul class="sectlevel2">
<li><a href="#_centos_7">CentOS 7</a></li>
<li><a href="#_rhel_7">RHEL 7</a></li>
<li><a href="#_postgresql">PostgreSQL</a></li>
<li><a href="#_docker">Docker</a></li>
<li><a href="#_openshift">OpenShift</a></li>
<li><a href="#_kubernetes">Kubernetes</a></li>
<li><a href="#_helm">Helm</a></li>
</ul>
</li>
<li><a href="#_creating_a_demo_namespace">Creating a Demo Namespace</a>
<ul class="sectlevel2">
<li><a href="#_kubernetes_2">Kubernetes</a></li>
<li><a href="#_openshift_2">OpenShift</a></li>
</ul>
</li>
<li><a href="#_next_steps">Next Steps</a></li>
</ul>
</div>
<div class="paragraph">
<p>v2.0, 2018-07-19</p>
</div>
<div class="sect1">
<h2 id="_requirements">Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Crunchy Container Suite can run on different environments including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Docker 1.12+</strong></p>
</li>
<li>
<p><strong>OpenShift Container Platform 3.6+</strong></p>
</li>
<li>
<p><strong>Kubernetes 1.8+</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this document we list the basic installation steps required for these
environments.</p>
</div>
<div class="paragraph">
<p>These installation instructions are developed and tested for the following operating systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CentOS 7</strong></p>
</li>
<li>
<p><strong>RHEL 7</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_environment">Project Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First add the following lines to your .bashrc file to set
the project paths:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>export GOPATH=$HOME/cdev
export GOBIN=$GOPATH/bin
export PATH=$PATH:$GOBIN
export CCP_BASEOS=centos7
export CCP_PGVERSION=10
export CCP_PG_FULLVERSION=10.4
export CCP_VERSION=2.0
export CCP_IMAGE_PREFIX=crunchydata
export CCP_IMAGE_TAG=$CCP_BASEOS-$CCP_PG_FULLVERSION-$CCP_VERSION
export CCPROOT=$GOPATH/src/github.com/crunchydata/crunchy-containers
export CCP_SECURITY_CONTEXT=""
export CCP_CLI=kubectl
export CCP_NAMESPACE=demo</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>Please see the <a href="https://crunchydata.github.io/crunchy-containers/installation/storage-configuration/">Storage Configuration</a> document
for configuring storage using environment variables set in .bashrc.</p>
</div>
<div class="paragraph">
<p>Additionally, the <code>CCP_CLI</code> setting above indicates you are running the
examples on a Kubernetes platform and not an OpenShift platform.  For
OpenShift, use the value of <strong>oc</strong> as the <code>CCP_CLI</code> variable instead.</p>
</div>
</div>

</div>
<div class="paragraph">
<p>It will be necessary to refresh your <code>.bashrc</code> file in order for the changes to take
effect.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>. ~/.bashrc</pre>
</div>
</div>
<div class="paragraph">
<p>Next, set up a project directory structure and pull down the project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mkdir -p $HOME/cdev/src $HOME/cdev/pkg $HOME/cdev/bin</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_requirements">Installing Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_centos_7">CentOS 7</h3>
<div class="literalblock">
<div class="content">
<pre>cd $GOPATH
sudo yum -y install golang git docker
go get github.com/tools/godep
cd src/github.com
mkdir crunchydata
cd crunchydata
git clone https://github.com/crunchydata/crunchy-containers
cd crunchy-containers
git checkout 2.0
go get github.com/blang/expenv</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>If you are a Crunchy enterprise customer, you will place the Crunchy repository
key and yum repository file into the <code>$CCPROOT/conf</code> directory at this point. These
files can be obtained through <a href="https://access.crunchydata.com/" class="bare">https://access.crunchydata.com/</a> on the downloads
page.</p>
</div>
</div>

</div>
</div>
<div class="sect2">
<h3 id="_rhel_7">RHEL 7</h3>
<div class="paragraph">
<p>When setting up the environment on RHEL 7, there are slightly different steps that
need to be taken.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd $GOPATH
sudo subscription-manager repos --enable=rhel-7-server-optional-rpms
sudo yum-config-manager --enable rhel-7-server-extras-rpms
sudo yum -y install git golang
go get github.com/tools/godep
cd src/github.com
mkdir crunchydata
cd crunchydata
git clone https://github.com/crunchydata/crunchy-containers
cd crunchy-containers
git checkout 2.0
go get github.com/blang/expenv</pre>
</div>
</div>
<div class="paragraph">
<div class="notices tip" ><div class="paragraph">
<p>If you are a Crunchy enterprise customer, you will place the Crunchy repository
key and yum repository file into the <code>$CCPROOT/conf</code> directory at this point. These
files can be obtained through <a href="https://access.crunchydata.com/" class="bare">https://access.crunchydata.com/</a> on the downloads
page.</p>
</div>
</div>

</div>
</div>
<div class="sect2">
<h3 id="_postgresql">PostgreSQL</h3>
<div class="paragraph">
<p>These installation instructions assume the installation of PostgreSQL 10
through the official PGDG repository. View the documentation located
<a href="https://wiki.postgresql.org/wiki/YUM_Installation">here</a> in
order to view more detailed notes or install a different version of PostgreSQL.</p>
</div>
<div class="paragraph">
<p>Locate and edit your distribution&#8217;s <code>.repo</code> file, located:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On CentOS: /etc/yum.repos.d/CentOS-Base.repo, [base] and [updates] sections</p>
</li>
<li>
<p>On Red Hat: /etc/yum/pluginconf.d/rhnplugin.conf [main] section</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To the section(s) identified above, you need to append a line (otherwise
dependencies might resolve to the PostgreSQL supplied by the base repository):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>exclude=postgresql*</pre>
</div>
</div>
<div class="paragraph">
<p>Next, install the RPM relating to the base operating system and PostgreSQL version
you wish to install. The RPMs can be found <a href="https://yum.postgresql.org/repopackages.php">here</a>.</p>
</div>
<div class="paragraph">
<p>For example, to install PostgreSQL 10 on a CentOS 7 system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-centos10-10-2.noarch.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>Or to install PostgreSQL 10 on a RHEL 7 system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install https://download.postgresql.org/pub/repos/yum/testing/10/redhat/rhel-7-x86_64/pgdg-redhat10-10-2.noarch.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll need to update your system:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y update</pre>
</div>
</div>
<div class="paragraph">
<p>Then, go ahead and install the PostgreSQL server package.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install postgresql10-server.x86_64</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_docker">Docker</h3>
<div class="paragraph">
<p>As good practice, at this point you&#8217;ll update your system.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y update</pre>
</div>
</div>
<div class="paragraph">
<p>Now we&#8217;ll install Docker.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum -y install docker</pre>
</div>
</div>
<div class="paragraph">
<p>After that, it&#8217;s necessary to add the <code>docker</code> group and give your user access
to that group (here referenced as <strong>someuser</strong>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo groupadd docker
sudo usermod -a -G docker someuser</pre>
</div>
</div>
<div class="paragraph">
<p>Remember to log out of the <strong>someuser</strong> account for the Docker group
to be added to your current session.  Once it&#8217;s added, you&#8217;ll be able
to run Docker commands from your user account.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>su - someuser</pre>
</div>
</div>
<div class="paragraph">
<p>You can ensure your <strong>someuser</strong> account is added correctly by running the following
command and ensuring <code>docker</code> appears as one of the results:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groups</pre>
</div>
</div>
<div class="paragraph">
<p>Before you start Docker, you might consider configuring Docker storage:
This is described if you run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>man docker-storage-setup</pre>
</div>
</div>
<div class="paragraph">
<p>Follow the instructions available <a href="https://docs.openshift.com/container-platform/3.4/install_config/install/host_preparation.html#configuring-docker-storage">on the main OpenShift documentation page</a>
to configure Docker storage appropriately.</p>
</div>
<div class="paragraph">
<p>These steps are illustrative of a typical process for setting up Docker storage. You will need to run these commands as root.</p>
</div>
<div class="paragraph">
<p>First, add an extra virtual hard disk to your virtual machine (see <a href="http://catlingmindswipe.blogspot.com/2012/02/how-to-create-new-virtual-disks-in.html">this blog post</a> for tips on how to do so).</p>
</div>
<div class="paragraph">
<p>Run this command to format the drive, where <code>/dev/sd?</code> is the new hard drive that was added:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fdisk /dev/sd?</pre>
</div>
</div>
<div class="paragraph">
<p>Next, create a volume group on the new drive partition within the <code>fdisk</code> utility:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>vgcreate docker-vg /dev/sd?</pre>
</div>
</div>
<div class="paragraph">
<p>Then, you&#8217;ll need to edit the <code>docker-storage-setup</code> configuration file in order to override default options. Add these two lines to <code>/etc/sysconfig/docker-storage-setup</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DEVS=/dev/sd?
VG=docker-vg</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, run the command <code>docker-storage-setup</code> to use that new volume group. The results should state that the physical volume <code>/dev/sd?</code> and the volume group <code>docker-vg</code> have both been successfully created.</p>
</div>
<div class="paragraph">
<p>Next, we enable and start up Docker:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl enable docker.service
sudo systemctl start docker.service</pre>
</div>
</div>
<div class="paragraph">
<p>Verify that Docker version 1.12.6 was installed, as per the OpenShift 3.6
<a href="https://docs.openshift.com/container-platform/3.6/install_config/install/host_preparation.html#installing-docker">requirements.</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker version</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift">OpenShift</h3>
<div class="paragraph">
<p>See the OpenShift installation guide for details on how to install
OpenShift Enterprise on your host. The main instructions are here:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.openshift.com/container-platform/3.6/install_config/install/quick_install.html" class="bare">https://docs.openshift.com/container-platform/3.6/install_config/install/quick_install.html</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you install OpenShift Enterprise on a server with less than <code>16GB</code> memory and <code>40GB</code>
of disk, the following Ansible variables need to be added to <code>~/.config/openshift/installer.cfg.yml</code>
prior to installation:
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>openshift_check_min_host_disk_gb: '10' # min 10gb disk
openshift_check_min_host_memory_gb: '3' # min 3gb memory</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes">Kubernetes</h3>
<div class="paragraph">
<p>See <a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/">kubeadm</a>
for installing the latest version of Kubernetes.</p>
</div>
<div class="paragraph">
<p>Please see <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/">here</a>
to view the official documentation regarding configuring DNS for your Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>Make sure your hostname resolves to a single IP address in your
/etc/hosts file. The NFS examples will not work otherwise and other problems
with installation can occur unless you have a resolving hostname.</p>
</div>
<div class="paragraph">
<p>You should see a single IP address returned from this command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>hostname --ip-address</pre>
</div>
</div>
<div class="paragraph">
<p>When running the containers in GKE Role Based Account Control will need to be set up.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>kubectl create clusterrolebinding cluster-admin-binding \
--clusterrole cluster-admin --user $(gcloud config get-value account)</pre>
</div>
</div>
<div class="paragraph">
<p>If more than one user will be running on the same kubernetes cluster in GKE, from the above command cluster-admin-binding will need to be unique and is the name that is added to the clusterrolebidings.  The example below will add another user to the clusterrolebinding with a unique value.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ACCOUNT=$(gcloud info --format='value(config.account)')
$ kubectl create clusterrolebinding &lt;unique&gt;-cluster-admin-binding \
    --clusterrole cluster-admin \
    --user $ACCOUNT

ACCOUNT is just your google gcloud acount login, ie username@google.com</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_helm">Helm</h3>
<div class="paragraph">
<p>Some Kubernetes Helm examples are provided in the following directory as one
option for deploying the Container Suite.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$CCPROOT/examples/helm/</pre>
</div>
</div>
<div class="paragraph">
<p>Once you have your Kubernetes environment configured, it is simple to get
Helm up and running. Please refer to <a href="https://github.com/kubernetes/helm/blob/master/docs/install.md">this document</a>
to get Helm installed and configured properly.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_demo_namespace">Creating a Demo Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Kubernetes, a concept called a <strong>namespace</strong> provides the means to separate
created resources or components into individual logically grouped partitions.</p>
</div>
<div class="paragraph">
<p>It is considered a best practice to have dedicated namespaces for projects in
both testing and production environments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All examples in the Crunchy Container Suite operate within the namespace
defined by the environment variable <code>$CCP_NAMESPACE</code>. The instructions below
illustrate how to set up and work within new namespaces or projects in both
Kubernetes and OpenShift.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_kubernetes_2">Kubernetes</h3>
<div class="paragraph">
<p>This section will illustrate how to set up a new Kubernetes namespace called <strong>demo</strong>, and will
then show how to provide permissions to that namespace to allow the Kubernetes examples to run
within that namespace.</p>
</div>
<div class="paragraph">
<p>First, view currently existing namespaces:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get namespace
NAME          STATUS    AGE
default       Active    21d
kube-public   Active    21d
kube-system   Active    21d</pre>
</div>
</div>
<div class="paragraph">
<p>Then, create a new namespace called <strong>demo</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create -f $CCPROOT/conf/demo-namespace.json
namespace "demo" created
$ kubectl get namespace demo
NAME      STATUS    AGE
demo      Active    7s</pre>
</div>
</div>
<div class="paragraph">
<p>Then set the namespace as the current location to avoid using the wrong namespace:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl config set-context $(kubectl config current-context) --namespace=demo</pre>
</div>
</div>
<div class="paragraph">
<p>We can verify that the namespace was set correctly through the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl config view | grep namespace:
    namespace: demo</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift_2">OpenShift</h3>
<div class="paragraph">
<p>This section assumes you are first logging into OpenShift as a normal
user such as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>oc login -u someuser</pre>
</div>
</div>
<div class="paragraph">
<p>For our development purposes only, we typically specify the OCP
Authorization policy of <code>AllowAll</code> as documented here:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.openshift.com/container-platform/3.7/install_config/configuring_authentication.html#AllowAllPasswordIdentityProvider" class="bare">https://docs.openshift.com/container-platform/3.7/install_config/configuring_authentication.html#AllowAllPasswordIdentityProvider</a></p>
</div>
<div class="paragraph">
<p>We do not recommend this authentication policy for a production
deployment of OCP.</p>
</div>
<div class="paragraph">
<p>The next step is to create a <strong>demo</strong> namespace to run the examples within. The
name of this OCP project will be what you supply in the CCP_NAMESPACE
environment variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc new-project demo --description="Crunchy Containers project" --display-name="Crunchy-Containers"
Now using project "demo" on server "https://127.0.0.1:8443".

$ export CCP_NAMESPACE=demo</pre>
</div>
</div>
<div class="paragraph">
<p>If we view the list of projects, we can see the new project has been added and is "active".</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc get projects
NAME        DISPLAY NAME         STATUS
demo        Crunchy-Containers   Active
myproject   My Project           Active</pre>
</div>
</div>
<div class="paragraph">
<p>If you were on a different project and wanted to switch to the demo project, you would do
so by running the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ oc project demo
Now using project "demo" on server "https://127.0.0.1:8443".</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you will want to ensure the proper privileges are added to the user in order to
have the ability to create persistent volumes. A command similar to the following can be
used to accomplish this, by adding the cluster-admin role to the <strong>demo</strong> user:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>oc adm policy add-cluster-role-to-user cluster-admin demo</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, build or pull the container images as demonstrated in the <a href="https://crunchydata.github.io/crunchy-containers/installation/build-the-containers/">Build the Containers</a> document.</p>
</div>
</div>
</div>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="https://crunchydata.github.io/crunchy-containers/installation/" title="Installation"> <i class="fa fa-chevron-left"></i><label>Installation</label></a>
    <a class="nav nav-next" href="https://crunchydata.github.io/crunchy-containers/installation/build-the-containers/" title="Build the Containers" style="margin-right: 0px;"><label>Build the Containers</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="https://crunchydata.github.io/crunchy-containers/js/clipboard.min.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/js/featherlight.min.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/js/html5shiv-printshiv.min.js"></script>

<script src="https://crunchydata.github.io/crunchy-containers/js/modernizr.custom.71422.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/js/docdock.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>