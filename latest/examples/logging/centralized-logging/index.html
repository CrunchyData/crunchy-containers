<!DOCTYPE html>
<html>
  <head>
    
    <title>Crunchy Data Container Suite Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.55.6" />
<title>Centralized Logging :: Crunchy Data Container Suite Documentation</title>
<link rel="shortcut icon" href="https://crunchydata.github.io/crunchy-containers/latest/favicon.png" type="image/x-icon" />
<link href="https://crunchydata.github.io/crunchy-containers/latest/css/nucleus.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/latest/theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="https://crunchydata.github.io/crunchy-containers/latest/css/Fort-Fonts.css" rel="stylesheet">
<link href="https://crunchydata.github.io/crunchy-containers/latest/css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="https://crunchydata.github.io/crunchy-containers/latest/js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="https://crunchydata.github.io/crunchy-containers/latest/js/main.js"></script>
<script src="https://crunchydata.github.io/crunchy-containers/latest/js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/crunchydata.github.io\/crunchy-containers\/latest";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/examples/logging/centralized-logging/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="https://crunchydata.github.io/crunchy-containers/latest/images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
      <nav class="shortcuts">
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/crunchy-containers" target="_blank" rel="noopener">
                    <i class='fab fa-github'></i> <label>Source</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://kubernetes.io/docs/" target="_blank" rel="noopener">
                    <i class='fas fa-bookmark'></i> <label>Kubernetes</label>
                  </a>
              </li>
              <li class="" role="">
                  <a href="https://github.com/CrunchyData/crunchy-containers/blob/master/LICENSE.md" target="_blank" rel="noopener">
                    <i class='fas fa-file-contract'></i> <label>License</label>
                  </a>
              </li>
      </nav>
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/latest/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/latest/js/auto-complete.js"></script>
        <link href="https://crunchydata.github.io/crunchy-containers/latest/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/crunchydata.github.io\/crunchy-containers\/latest";
          
        </script>
        <script type="text/javascript" src="https://crunchydata.github.io/crunchy-containers/latest/js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="https://crunchydata.github.io/crunchy-containers/latest/">Crunchy Data Container Suite Documentation</a>
      <hr>
        <b>Available Formats</b>
        <nav class="downloads">
                <li class="" role="">
                    <a href="https://crunchydata.github.io/crunchy-containers/latest/pdf/crunchy_containers.pdf" target="_blank" rel="noopener">
                      <i class='fas fa-file-pdf'></i> <label>PDF</label>
                    </a>
                </li>
                <li class="" role="">
                    <a href="https://crunchydata.github.io/crunchy-containers/latest/epub/crunchy_containers.epub" target="_blank" rel="noopener">
                      <i class='fas fa-book'></i> <label>EPUB</label>
                    </a>
                </li>
        </nav>
        <hr>

      <b>Navigation</b>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/overview/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/overview/">Overview</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/overview/overview/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/overview/overview/">
            Container Images
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/overview/supported/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/overview/supported/">
            Supported Platforms
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/">Client User Guide</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/user-guide/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/user-guide/">
            User Guide
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/usage/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/client-user-guide/usage/">
            Using the Images
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/" class="dd-item parent haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/">Examples</a>
            <i class="fas fa-angle-down fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/primary/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/primary/">
            PostgreSQL Primary
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/custom-config/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/custom-config/">
            Custom Configuration of PostgreSQL Container
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/custom-config-ssl/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/custom-config-ssl/">
            Custom Configuration of PostgreSQL Container with SSL
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/primary-replica/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/primary-replica/">
            Primary and Streaming Replica Containers
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/sync-replica/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/sync-replica/">
            Synchronous Replication
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/postgis/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/postgresql/postgis/">
            PostGIS Container
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/poolers/pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/poolers/pgpool/">
            pgPool II
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgbackrest/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgbackrest/">
            pgBackRest
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgbasebackup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgbasebackup/">
            pgBaseBackup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgdump-pgrestore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/backup-restoration/pgdump-pgrestore/">
            pgDump &amp; pgRestore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/poolers/pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/poolers/pgbouncer/">
            pgBouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/metrics/pgbadger/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/metrics/pgbadger/">
            pgBadger
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/metrics/pgbench/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/metrics/pgbench/">
            pgBench
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/logging/centralized-logging/" class="dd-item active">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/logging/centralized-logging/">
            Centralized Logging
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/logging/pgaudit/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/logging/pgaudit/">
            pgAudit
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/administration/upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/administration/upgrade/">
            Upgrade
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/examples/administration/pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/examples/administration/pgadmin4/">
            pgAdmin 4
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/">Installation Guide</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/installation-guide/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/installation-guide/">
            Installation Guide
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/storage-configuration/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/installation-guide/storage-configuration/">
            Storage Configuration
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/">Container Specifications</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgadmin4/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgadmin4/">
            crunchy-pgadmin4
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbackrest/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbackrest/">
            crunchy-pgbackrest
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbackrest-repo/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbackrest-repo/">
            crunchy-pgbackrest-repo
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbadger/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbadger/">
            crunchy-pgbadger
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbouncer/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgbouncer/">
            crunchy-pgbouncer
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgpool/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-pgpool/">
            crunchy-pgpool
          </a>
        </div>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/">crunchy-postgres</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/postgres/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/postgres/">
            postgres
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/backup/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/backup/">
            backup
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgbasebackup-restore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgbasebackup-restore/">
            pgbasebackup-restore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgbench/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgbench/">
            pgbench
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgdump/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgdump/">
            pgdump
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgrestore/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/pgrestore/">
            pgrestore
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/sqlrunner/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres/sqlrunner/">
            sqlrunner
          </a>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres-appdev/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres-appdev/">
            crunchy-postgres-appdev
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres-gis/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-postgres-gis/">
            crunchy-postgres-gis
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-upgrade/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/container-specifications/crunchy-upgrade/">
            crunchy-upgrade
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/contributing/" class="dd-item haschildren
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/contributing/">Contributing</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/contributing/building/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/contributing/building/">
            Building the Containers
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/contributing/issues/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/contributing/issues/">
            Submitting Issues
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/contributing/pull-requests/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/contributing/pull-requests/">
            Submitting Pull Requests
          </a>
        </div>
    </li>
      <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/contributing/documentation-updates/" class="dd-item">
        <div>
          <a href="https://crunchydata.github.io/crunchy-containers/latest/contributing/documentation-updates/">
            
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://crunchydata.github.io/crunchy-containers/latest/troubleshooting/" class="dd-item
        ">
      <div>
      <a href="https://crunchydata.github.io/crunchy-containers/latest/troubleshooting/">Troubleshooting</a>

      </div>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/overview/" >
   Overview</option>
    <option value="/client-user-guide/" >
   Client User Guide</option>
    <option value="/examples/" >
   Examples</option> 
      <option value="/examples/postgresql/primary/" >- PostgreSQL Primary</option>
      <option value="/examples/postgresql/custom-config/" >- Custom Configuration of PostgreSQL Container</option>
      <option value="/examples/postgresql/custom-config-ssl/" >- Custom Configuration of PostgreSQL Container with SSL</option>
      <option value="/examples/postgresql/primary-replica/" >- Primary and Streaming Replica Containers</option>
      <option value="/examples/postgresql/sync-replica/" >- Synchronous Replication</option>
      <option value="/examples/postgresql/postgis/" >- PostGIS Container</option>
      <option value="/examples/poolers/pgpool/" >- pgPool II</option>
      <option value="/examples/backup-restoration/pgbackrest/" >- pgBackRest</option>
      <option value="/examples/backup-restoration/pgbasebackup/" >- pgBaseBackup</option>
      <option value="/examples/backup-restoration/pgdump-pgrestore/" >- pgDump &amp; pgRestore</option>
      <option value="/examples/poolers/pgbouncer/" >- pgBouncer</option>
      <option value="/examples/metrics/pgbadger/" >- pgBadger</option>
      <option value="/examples/metrics/pgbench/" >- pgBench</option>
      <option value="/examples/logging/centralized-logging/"  selected>- Centralized Logging</option>
      <option value="/examples/logging/pgaudit/" >- pgAudit</option>
      <option value="/examples/administration/upgrade/" >- Upgrade</option>
      <option value="/examples/administration/pgadmin4/" >- pgAdmin 4</option>
  
    <option value="/installation-guide/" >
   Installation Guide</option>
    <option value="/container-specifications/" >
   Container Specifications</option>
    <option value="/contributing/" >
   Contributing</option>
    <option value="/troubleshooting/" >
   Troubleshooting</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="https://crunchydata.github.io/crunchy-containers/latest/contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/crunchy-containers/edit/master/docs/content/examples/logging/centralized-logging.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            







 <a href='https://crunchydata.github.io/crunchy-containers/latest/'>Introduction</a> > <a href='https://crunchydata.github.io/crunchy-containers/latest/examples/'>Examples</a> > Centralized Logging

 

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Centralized Logging</h1>

    

    
    

<h2 id="centralized-logging-example">Centralized Logging Example</h2>

<p>The logs generated by containers are critical for deployments because they provide insights into the
health of the system.  PostgreSQL logs are very detailed and there is some information that can only be
obtained from logs (but not limited to):</p>

<ul>
<li>Connections and Disconnections of users</li>
<li>Checkpoint Statistics</li>
<li>PostgreSQL Server Errors</li>
</ul>

<p>Aggregrating container logs across multiple hosts allows administrators to audit, debug problems and prevent
repudiation of misconduct.</p>

<p>In the following example we will demonstrate how to setup Kubernetes and OpenShift to use centralized logging by using
an EFK (Elasticsearch, Fluentd and Kibana) stack.  Fluentd will run as a daemonset on each host within the Kubernetes
cluster and extract container logs, Elasticsearch will consume and index the logs gathered by Fluentd and Kibana will allow
users to explore and visualize the logs via a web dashboard.</p>

<p>To learn more about the EFK stack, see the following:</p>

<ul>
<li><a href="https://www.elastic.co/products/elasticsearch">https://www.elastic.co/products/elasticsearch</a></li>
<li><a href="https://www.fluentd.org/architecture">https://www.fluentd.org/architecture</a></li>
<li><a href="https://www.elastic.co/products/kibana">https://www.elastic.co/products/kibana</a></li>
</ul>

<h2 id="configure-postgresql-for-centralized-logging">Configure PostgreSQL for Centralized Logging</h2>

<p>By default, Crunchy PostgreSQL logs to files in the <code>/pgdata</code> directory.  In order to get the logs
out of the container we need to configure PostgreSQL to log to <code>stdout</code>.</p>

<p>The following settings should be configured in <code>postgresql.conf</code> to make PostgreSQL log to <code>stdout</code>:</p>

<pre><code>log_destination = 'stderr'
logging_collector = off
</code></pre>

<div class="notices warning" >
Changes to logging settings require a restart of the PostgreSQL container to take effect.
</div>

<h2 id="deploying-the-efk-stack-on-openshift-container-platform">Deploying the EFK Stack On OpenShift Container Platform</h2>

<p>OpenShift Container Platform can be installed with an EFK stack.  For more information about
configuring OpenShift to create an EFK stack, see the official documentation:</p>

<ul>
<li><a href="https://docs.openshift.com/container-platform/3.11/install_config/aggregate_logging.html">https://docs.openshift.com/container-platform/3.11/install_config/aggregate_logging.html</a></li>
</ul>

<h2 id="deploying-the-efk-stack-on-kubernetes">Deploying the EFK Stack On Kubernetes</h2>

<p>First, deploy the EFK stack by running the example using the following commands:</p>

<pre><code>cd $CCPROOT/examples/kube/centralized-logging/efk
./run.sh
</code></pre>

<div class="notices warning" >
Elasticsearch is configured to use an `emptyDir` volume in this example.  Configure this example to provide a
persistent volume when deploying into production.
</div>

<p>Next, verify the pods are running in the <code>kube-system</code> namespace:</p>

<pre><code>${CCP_CLI?} get pods -n kube-system --selector=k8s-app=elasticsearch-logging
${CCP_CLI?} get pods -n kube-system --selector=k8s-app=fluentd-es
${CCP_CLI?} get pods -n kube-system --selector=k8s-app=kibana-logging
</code></pre>

<p>If all pods deployed successfully, Elasticsearch should already be receiving container logs from Fluentd.</p>

<p>Next we will deploy a PostgreSQL Cluster (primary and replica deployments) to demonstrate PostgreSQL logs
are being captured by Fluentd.</p>

<p>Deploy the PostgreSQL cluster by running the following:</p>

<pre><code>cd $CCPROOT/examples/kube/centralized-logging/postgres-cluster
./run.sh
</code></pre>

<p>Next, verify the pods are running:</p>

<pre><code>${CCP_CLI?} get pods --selector=k8s-app=postgres-cluster
</code></pre>

<p>With the PostgreSQL successfully deployed, we can now query the logs in Kibana.</p>

<p>We will need to setup a port-forward to the Kibana pod to access it.  To do that
we first get the name of the pod by running the following command:</p>

<pre><code>${CCP_CLI?} get pod --selector=k8s-app=kibana-logging -n kube-system
</code></pre>

<p>Next, start the port-forward:</p>

<pre><code>${CCP_CLI?} port-forward &lt;KIBANA POD NAME&gt; 5601:5601 -n kube-system
</code></pre>

<p>To access the web dashboard navigate in a browser to <code>127.0.0.1:5601</code>.</p>

<p>First, click the <code>Discover</code> tab and setup an index pattern to use for queries.</p>

<p>The index pattern name we will use is <code>logstash-*</code> because Fluentd is configured to
generate logstash style logs.</p>

<p>Next we will configure the <code>Time Filter field name</code> to be <code>@timestamp</code>.</p>

<p>Now that our index pattern is created, we can query for the container logs.</p>

<p>Click the <code>Discover</code> tab and use the following queries:</p>

<pre><code># KUBERNETES
CONTAINER_NAME: *primary* AND MESSAGE: &quot;.*LOG*&quot;
# OpenShift
kubernetes.pod_name: &quot;primary&quot; AND log
</code></pre>

<p>For more information about querying Kibana, see the official documentation: <a href="https://www.elastic.co/guide/en/beats/packetbeat/current/kibana-queries-filters.html">https://www.elastic.co/guide/en/beats/packetbeat/current/kibana-queries-filters.html</a></p>

<p>To delete the centralized logging example run the following:</p>

<pre><code>${CCP_ROOT?}/examples/kube/centralized-logging/efk/cleanup.sh
</code></pre>

<p>To delete the cluster roles required by the EFK stack, as an administrator, run the following:</p>

<pre><code>${CCP_ROOT?}/examples/kube/centralized-logging/efk/cleanup-rbac.sh
</code></pre>



    
      <div class="text-center">
  <p><small>&copy; 2017 - 2021 Crunchy Data Solutions, Inc.</small></p>
</div>

    

    
    

    
  </body>
</html>
